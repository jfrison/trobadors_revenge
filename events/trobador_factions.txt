namespace = trobador_faction

# Initialising factions
country_event = {
	id = trobador_faction.1
	title = "trobador_faction_1_title"
	desc = "trobador_faction_1_desc"
	picture = DEBATE_REPUBLICAN_eventPicture

	trigger = {
		OR = {
			tag = AMG  # Unfortunately each country needs to have its own GUI, otherwise it crashes
			tag = AUV
			#tag = AVI # Not sure we want to apply this to Avignon, where the France/Vatican opposition is the most important
			tag = BER
			tag = DAU
			tag = FOI
			tag = GUY
			tag = OCC
			tag = PRO
			tag = TOU
		}
		OR = {
			primary_culture = gascon
			primary_culture = aquitaine
			primary_culture = occitain
			primary_culture = provencal
			primary_culture = occitan
 		}
		has_factions = no
		NOT = { has_country_flag = trobador_factions_dissolved } # for the moment there is no event to set such a flag, but I should think about it
	}

	mean_time_to_happen = {
		months = 1
	}
	
	immediate = {
		hidden_effect = {
			add_faction = trobador_occitanist
			add_faction = trobador_republican
			add_faction = trobador_french
			add_faction = trobador_aragonese 
			add_faction_influence = { # default
				faction = trobador_french
				influence = 50
			}
			add_faction_influence = { # default
				faction = trobador_occitanist
				influence = 20
			}
			add_faction_influence = { # default
				faction = trobador_republican
				influence = 20
			}
			add_faction_influence = { # default
				faction = trobador_aragonese
				influence = 10
			}
			if = {
				limit = { vassal_of = FRA }
				add_faction_influence = {
					faction = trobador_french
					influence = 100
				}
			}
			if = {
				limit = { vassal_of = ARA }
				add_faction_influence = {
					faction = trobador_aragonese
					influence = 100
				}
			}
			if = {
				limit = { is_subject = no }
				add_faction_influence = {
					faction = trobador_french
					influence = -15
				}
				add_faction_influence = {
					faction = trobador_aragonese
					influence = -15
				}
			}
			if = {
				limit = { culture_group = occitanocatala }
				add_faction_influence = {
					faction = trobador_occitanist
					influence = 33
				}
			}
		}
	}

	option = {
		name = "trobador_faction_1_opta"		# Encourage occitanists
		add_faction_influence = {
			faction = trobador_occitanist
			influence = 15
		}
		create_advisor = trobador
	}
	option = {
		name = "trobador_faction_1_optb"		# Encourage republicans
		add_faction_influence = {
			faction = trobador_republican
			influence = 15
		}
		add_republican_tradition = 5
		create_advisor = trader
	}
	option = {
		name = "trobador_faction_1_optc"		# Encourage French
		add_faction_influence = {
			faction = trobador_french
			influence = 15
		}
		FRA = {
			add_opinion = {
				who = ROOT
				modifier = opinion_pleased
			}
		}
	}
	option = {
		name = "trobador_faction_1_optd"		# Encourage Aragonese
		add_faction_influence = {
			faction = trobador_aragonese
			influence = 15
		}
		ARA = {
			add_opinion = {
				who = ROOT
				modifier = opinion_pleased
			}
		}
	}
}
